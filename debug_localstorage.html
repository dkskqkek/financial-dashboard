<!DOCTYPE html>
<html>
<head>
    <title>LocalStorage ë””ë²„ê¹… ë„êµ¬</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .debug-section { margin: 20px 0; padding: 15px; border: 1px solid #ccc; border-radius: 5px; }
        .code-block { background: #f5f5f5; padding: 10px; border-radius: 3px; margin: 10px 0; }
        button { padding: 10px 15px; margin: 5px; background: #007bff; color: white; border: none; border-radius: 3px; cursor: pointer; }
        button:hover { background: #0056b3; }
        .result { background: #e9f7ef; padding: 10px; border-radius: 3px; margin: 10px 0; }
        .error { background: #f8d7da; padding: 10px; border-radius: 3px; margin: 10px 0; }
    </style>
</head>
<body>
    <h1>ğŸ”§ Financial Dashboard - LocalStorage ë””ë²„ê¹… ë„êµ¬</h1>
    
    <div class="debug-section">
        <h2>ğŸ“Š í˜„ì¬ LocalStorage ìƒíƒœ</h2>
        <button onclick="checkAllStorage()">ì „ì²´ ìŠ¤í† ë¦¬ì§€ í™•ì¸</button>
        <button onclick="checkFinancialStore()">Financial Storeë§Œ í™•ì¸</button>
        <button onclick="clearStorage()">ìŠ¤í† ë¦¬ì§€ í´ë¦¬ì–´</button>
        <div id="storage-result"></div>
    </div>

    <div class="debug-section">
        <h2>ğŸ·ï¸ Zustand ìŠ¤í† ì–´ í‚¤ í™•ì¸</h2>
        <p>ì˜ˆìƒë˜ëŠ” í‚¤: <code>financial-dashboard-store</code></p>
        <button onclick="checkStoreKey()">ìŠ¤í† ì–´ í‚¤ í™•ì¸</button>
        <div id="key-result"></div>
    </div>

    <div class="debug-section">
        <h2>ğŸ“ˆ ì£¼ì‹ ë°ì´í„° ë³µêµ¬ í…ŒìŠ¤íŠ¸</h2>
        <button onclick="testBackupData()">ë°±ì—… ë°ì´í„° í™•ì¸</button>
        <button onclick="createTestData()">í…ŒìŠ¤íŠ¸ ë°ì´í„° ìƒì„±</button>
        <div id="backup-result"></div>
    </div>

    <script>
        function checkAllStorage() {
            const result = document.getElementById('storage-result');
            let html = '<div class="result"><h3>ì „ì²´ LocalStorage ë‚´ìš©:</h3>';
            
            if (localStorage.length === 0) {
                html += '<p style="color: red;">âŒ LocalStorageê°€ ë¹„ì–´ìˆìŠµë‹ˆë‹¤!</p>';
            } else {
                html += `<p>âœ… ì´ ${localStorage.length}ê°œì˜ í‚¤ê°€ ìˆìŠµë‹ˆë‹¤:</p><ul>`;
                for (let i = 0; i < localStorage.length; i++) {
                    const key = localStorage.key(i);
                    const value = localStorage.getItem(key);
                    html += `<li><strong>${key}</strong>: ${value ? value.substring(0, 100) + '...' : 'null'}</li>`;
                }
                html += '</ul>';
            }
            html += '</div>';
            result.innerHTML = html;
        }

        function checkFinancialStore() {
            const result = document.getElementById('storage-result');
            const storeKey = 'financial-dashboard-store';
            const data = localStorage.getItem(storeKey);
            
            let html = '<div class="result"><h3>Financial Dashboard Store:</h3>';
            if (data) {
                try {
                    const parsed = JSON.parse(data);
                    html += `<p>âœ… ìŠ¤í† ì–´ ë°ì´í„° ë°œê²¬!</p>`;
                    html += `<p><strong>Stocks:</strong> ${parsed.state?.stocks ? parsed.state.stocks.length + 'ê°œ' : 'ì—†ìŒ'}</p>`;
                    html += `<p><strong>Cash Accounts:</strong> ${parsed.state?.cashAccounts ? parsed.state.cashAccounts.length + 'ê°œ' : 'ì—†ìŒ'}</p>`;
                    html += `<p><strong>ì‚¬ìš©ì:</strong> ${parsed.state?.user ? parsed.state.user.name || 'Unknown' : 'ì—†ìŒ'}</p>`;
                    html += `<div class="code-block">${JSON.stringify(parsed, null, 2).substring(0, 500)}...</div>`;
                } catch (e) {
                    html += `<p style="color: red;">âŒ JSON íŒŒì‹± ì‹¤íŒ¨: ${e.message}</p>`;
                    html += `<div class="code-block">${data.substring(0, 200)}...</div>`;
                }
            } else {
                html += '<p style="color: red;">âŒ Financial Dashboard ìŠ¤í† ì–´ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤!</p>';
            }
            html += '</div>';
            result.innerHTML = html;
        }

        function checkStoreKey() {
            const result = document.getElementById('key-result');
            let html = '<div class="result"><h3>ìŠ¤í† ì–´ í‚¤ ê²€ìƒ‰ ê²°ê³¼:</h3>';
            
            const possibleKeys = [
                'financial-dashboard-store',
                'financial-store',
                'dashboard-store',
                'app-store'
            ];
            
            let found = false;
            for (const key of possibleKeys) {
                const data = localStorage.getItem(key);
                if (data) {
                    html += `<p>âœ… ë°œê²¬: <code>${key}</code></p>`;
                    found = true;
                } else {
                    html += `<p>âŒ ì—†ìŒ: <code>${key}</code></p>`;
                }
            }
            
            if (!found) {
                html += '<p style="color: red;">âš ï¸ ì•Œë ¤ì§„ ìŠ¤í† ì–´ í‚¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤!</p>';
            }
            
            html += '</div>';
            result.innerHTML = html;
        }

        function clearStorage() {
            if (confirm('ì •ë§ë¡œ LocalStorageë¥¼ ëª¨ë‘ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                localStorage.clear();
                document.getElementById('storage-result').innerHTML = 
                    '<div class="error">âš ï¸ LocalStorageê°€ ëª¨ë‘ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤!</div>';
            }
        }

        function testBackupData() {
            const result = document.getElementById('backup-result');
            
            // ë°±ì—… í‚¤ë“¤ í™•ì¸
            const backupKeys = Object.keys(localStorage).filter(key => 
                key.includes('backup') || key.includes('financial')
            );
            
            let html = '<div class="result"><h3>ë°±ì—… ë°ì´í„° ê²€ìƒ‰:</h3>';
            
            if (backupKeys.length > 0) {
                html += '<p>âœ… ë°±ì—… ê´€ë ¨ í‚¤ ë°œê²¬:</p><ul>';
                backupKeys.forEach(key => {
                    html += `<li><strong>${key}</strong></li>`;
                });
                html += '</ul>';
            } else {
                html += '<p style="color: red;">âŒ ë°±ì—… ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤!</p>';
            }
            
            html += '</div>';
            result.innerHTML = html;
        }

        function createTestData() {
            const testData = {
                version: 0,
                state: {
                    stocks: [
                        {
                            id: "test-1",
                            symbol: "AAPL",
                            name: "Apple Inc.",
                            quantity: 10,
                            avgPrice: 150.00,
                            currentPrice: 175.00,
                            marketValue: 1750.00,
                            currency: "USD"
                        }
                    ],
                    cashAccounts: [
                        {
                            id: "test-cash-1",
                            name: "í…ŒìŠ¤íŠ¸ ê³„ì¢Œ",
                            balance: 1000000,
                            currency: "KRW"
                        }
                    ],
                    user: {
                        id: "test-user",
                        name: "í…ŒìŠ¤íŠ¸ ì‚¬ìš©ì"
                    }
                }
            };
            
            localStorage.setItem('financial-dashboard-store', JSON.stringify(testData));
            
            document.getElementById('backup-result').innerHTML = 
                '<div class="result">âœ… í…ŒìŠ¤íŠ¸ ë°ì´í„°ê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤! í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•´ì„œ í™•ì¸í•´ë³´ì„¸ìš”.</div>';
        }

        // í˜ì´ì§€ ë¡œë“œì‹œ ìë™ìœ¼ë¡œ ìƒíƒœ í™•ì¸
        window.onload = function() {
            checkAllStorage();
            checkFinancialStore();
        };
    </script>
</body>
</html>